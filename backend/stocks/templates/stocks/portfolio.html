<!DOCTYPE html>

<html>

<title>PORTFOLIO</title>

<script>

</script>

<body>

<style>
    table,
    th,
    td {
        border: 1px solid black;
        background-color: white;
        align-items: center;
        padding: 10px;
        margin: auto;
        font-family: Arial;
    }

    h1 {
        justify-content: center;
    }

    #maintitle{
        font-family: arial;
    }

    #resetbutton{
        background-color: grey;
    }

    .container {
        display: flex;
    }

    .search-selection {
        flex: 1;
        padding: 10px;
        background-color: grey;
    }

    .portfolio-section {
        padding: 10px;
        flex: 2;
        background-color: lightslategray;
    }

    .portfolio-variables{
        background-color: navy;
        color:white;
        font-weight: bold;
    }

    .portfolio-values{
        background-color: white;
    }

    .search-results{
        padding: 10px;
        margin-top: 10px;
        background-color: yellow;
        font-family:Arial;
    }


</style>

<h1 id="maintitle"><center>STOCK TRACK PORTFOLIO</center></h1>

<div class="container">

    <div class="search-selection">
        <h2><center>SEARCH STOCKS</center></h2>

        <form method="POST">
            <center>
            {% csrf_token %}
            <input type="text" name="ticker" placeholder="Enter Ticker Here">
            <button type="submit" name="search">Search</button>
            </center>
        </form>

        {% if search_results %}
            <div class="search-results">
                <h3>{{ search_results.ticker }} | {{ search_results.company_name }}</h3>
                <p>Current Price: ${{ search_results.current_price }}</p>
                
                <form method="POST">

                    {% csrf_token %}
                    <input type="hidden" name="ticker" value="{{ search_results.ticker }}">
                    <input type="hidden" name="company_name" value="{{ search_results.company_name }}">
                    <input type="hidden" name="current_price" value="{{ search_results.current_price }}">
                    
                    <label>Upper Limit:</label>
                    <input type="number" name="upper_limit" step="0.01" required>
                    <br>
                    <label>Lower Limit:</label>
                    <input type="number" name="lower_limit" step="0.01" required>
                    <br>
                    <label>Alert</label>
                    <input type="radio" name="alertstatus" value="on"> 
                    <br>
                    <button type="submit" name="add_stock">Add to Portfolio</button>
                </form>
            </div>

        {% endif %}

    </div>

    <div class="portfolio-section">
        <table>
            <tr>
                <td class="portfolio-variables">Ticker</td>
                <td class="portfolio-variables">Company</td>
                <td class="portfolio-variables">Current</td>
                <td class="portfolio-variables">Upper</td>
                <td class="portfolio-variables">Lower</td>
                <td class="portfolio-variables">Alert</td>
                <td id="resetbutton">
                    <form method="POST">
                        {% csrf_token %}
                            <input type="hidden" name="resetAlerts">
                            <button type="submit" name="reset_alerts">RESET</button>                       
                    </form>
                </td>
            </tr>
            {% for item in stock_data %}
            <tr class="portfolio-values">
                <td>{{ item.ticker }}</td>
                <td>{{ item.company_name }}</td>
                <td>${{ item.current_price }}</td>
                <td>${{ item.upperLimit }}</td>
                <td>${{ item.lowerLimit }}</td>
                <td>
                    {% if item.alertEnabled %}
                    ON
                    {% else %}
                    OFF
                    {% endif %}
                </td>
                <td>
                    <form method="POST">
                        {% csrf_token %}

                        <input type="hidden" name="stock_id" value="{{ item.stock.id }}">
                        <button type="submit" name="delete">DELETE</button>
                    </form>

                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>

<script>
    setInterval(() => location.reload(), 60000);
</script>

</body>

</html>